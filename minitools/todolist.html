<!DOCTYPE html><html><head><title>Do First Things</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><link rel="shortcut icon" type="image/png" href="../favicon.ico"><style>*{margin:0;padding:0;box-sizing:border-box;outline:none}body{font-family:"Helvetica Neue",Helvetica,'Microsoft YaHei',Arial,sans-serif;background:#f5f5f5;color:#2c3e50}a{text-decoration:none;color:inherit}header{background:#2c3e50;padding:.5em 0;position:sticky;top:0;z-index:10}.header-content{display:flex;align-items:center;justify-content:center;max-width:600px;margin:0 auto}header input{width:100%;height:2.5em;padding:0 1em;border:none;border-radius:3px;background:rgba(255,255,255,.1);color:#ddd;font-size:1em}header input::placeholder{color:#ccc}section{max-width:600px;margin:0 auto;padding:1em}.tasks-heading{cursor:pointer;display:inline-block}h2{font-size:1.5em;margin-bottom:1em;color:#2c3e50}span{font-size:.8em;color:#666}ol,ul{list-style:none;padding:0;margin:0}li{display:flex;align-items:center;background:#fff;padding:.5em 1em;margin-bottom:1em;border-left:5px solid #0063b1;box-shadow:0 2px 3px rgba(0,0,0,.1);cursor:pointer;width:100%}ul li{border-left-color:#999;opacity:.5;text-decoration:line-through}li input[type="checkbox"]{margin-right:1em;margin-top:3px;cursor:pointer}li p{flex:1;margin:0;font-size:1.1em}li a{color:#ff6b6b;font-size:1.2em;cursor:pointer}.menu-items{display:none;position:absolute;top:6em;background:#2c3e50;border:1px solid #34495e;border-radius:3px;box-shadow:0 2px 5px rgba(0,0,0,.2);z-index:10}.menu-items a{display:block;padding:.8em 1.5em;color:#ddd;white-space:nowrap;font-size:1em}.menu-items a:hover{background:#34495e}.menu-items.show{display:block}@media screen and (max-width:600px){.header-content{padding:.5em}header input{font-size:.9em}.menu-items{top:5.5em}}@media screen and (max-width:400px){header input{font-size:.8em}.menu-items{top:5.2em}}</style></head><body><header><div class="header-content"><input type="text" id="title" name="title" placeholder="+ Add a task" required autocomplete="off"></div></header><section><div class="tasks-heading" onclick="App.toggleMenu(event)"><h2 id="tasks-heading">Tasks <span id="todocount">0</span></h2></div><div class="menu-items"><a href="../so.html">Home</a><a href="javascript:App.clearCompleted()">Clear Completed</a></div><ol id="todolist" aria-labelledby="tasks-heading"></ol><h2 id="completed-heading">Completed <span id="donecount">0</span></h2><ul id="donelist" aria-labelledby="completed-heading"></ul></section><script>const DataService={loadData(){const e=localStorage.getItem("todo");return e?JSON.parse(e):[]},saveData(e){localStorage.setItem("todo",JSON.stringify(e))},addItem(e){const t=this.loadData();t.push({title:e,done:!1}),this.saveData(t)},removeItem(e){const t=this.loadData();t.splice(e,1),this.saveData(t)},updateItem(e,t,s){const a=this.loadData();a[e][t]=s,this.saveData(a)},clearCompleted(){const e=this.loadData(),t=e.filter(e=>!e.done);this.saveData(t)}},DomService={renderList(e,t,s){const a=document.getElementById(t);let l="";e.forEach((e,t)=>{e.done===s&&(l+=`<li><input type="checkbox" onchange="App.updateItem(${t}, 'done', ${!s})" ${s?"checked":""}><p id="p-${t}" onclick="App.editItem(${t})">${e.title}</p><a href="javascript:App.removeItem(${t})">❌</a></li>`)}),a.innerHTML=l},renderCounts(e,t){document.getElementById("todocount").innerHTML=e,document.getElementById("donecount").innerHTML=t},resetForm(){document.getElementById("title").value=""}},App={init(){this.load(),document.getElementById("title").addEventListener("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),this.postAction())}),window.addEventListener("click",e=>{e.target.closest(".tasks-heading")||e.target.closest(".menu-items")||this.hideMenu()}),window.addEventListener("storage",()=>this.load(),!1)},load(){const e=DataService.loadData(),t=e.filter(e=>!e.done).length,s=e.filter(e=>e.done).length;DomService.renderList(e,"todolist",!1),DomService.renderList(e,"donelist",!0),DomService.renderCounts(t,s)},postAction(){const e=document.getElementById("title"),t=e.value.trim();if(!t)return void alert("内容不能为空");DataService.addItem(t),DomService.resetForm(),this.load()},removeItem(e){DataService.removeItem(e),this.load()},updateItem(e,t,s){DataService.updateItem(e,t,s),this.load()},editItem(e){const t=document.getElementById(`p-${e}`),s=t.innerHTML;t.innerHTML=`<input id="input-${e}" value="${s}" />`;const a=document.getElementById(`input-${e}`);a.setSelectionRange(0,a.value.length),a.focus(),a.onblur=()=>{0===a.value.length?(t.innerHTML=s,alert("内容不能为空")):this.updateItem(e,"title",a.value)}},toggleMenu(e){e.stopPropagation();const t=document.querySelector(".menu-items");t&&t.classList.toggle("show")},hideMenu(){const e=document.querySelector(".menu-items");e&&e.classList.remove("show")},clearCompleted(){DataService.clearCompleted(),this.load()}};window.onload=()=>App.init();</script></body></html>